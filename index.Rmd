---
title: "Bivariate Exercises"
author: "Ana Chkheidze"
output:
  html_document:
    df_print: paged
---

```{r load_link, eval=TRUE}
link="https://github.com/EvansDataScience/data/raw/master/crime.RData"
load(file = url(link))
```

```{r callggplot, eval=TRUE}
library(ggplot2)
```

-------Exercise 1-------

```{r}

```







--------Exercise 2-------

```{r heatmap, eval=TRUE}
CrimeCol=table(crime$crimecat,crime$Occurred.DayTime)%>%
         prop.table(margin = 2)%>%   # 2 is % by column
         "*"(100)%>%
         round(3)
df.C=as.data.frame(CrimeCol)
colnames(df.C)=c('Crime','Daytime','Percent')
```


Change the heatplot to ascending order, where intensity goes from yellow to purple.
```{r head_ascending, eval=TRUE}
base  = ggplot(df.C, aes(x = Daytime, y = reorder(Crime, -Percent), fill = Percent)) 
heat1 = base +  geom_tile()
heat2 = heat1 +scale_fill_gradient(low = "yellow", 
                                   high = "purple")

heat3 = heat2 + theme_classic() 

heat4 = heat3 + theme(axis.text.x = element_text(angle = 90, vjust = 0.6), 
                      legend.title = element_blank(), #no title for legend
                      legend.position="top", 
                      legend.direction="horizontal",
                      legend.key.width=unit(1, "cm"),
                      legend.key.height=unit(1, "cm")) 

heat4 + labs(y="Crime")
```

-------Exercise 3-------------

```{r}

```


